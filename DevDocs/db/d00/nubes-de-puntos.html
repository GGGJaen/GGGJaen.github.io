<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GEU: Nubes de puntos</title>
<link rel="icon" href="../../Logo.ico" type="image/x-icon" />
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../custom.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Logo.ico"/></td>
  <td id="projectalign">
   <div id="projectname">GEU<span id="projectnumber">&#160;0.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generado por Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Buscar',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('db/d00/nubes-de-puntos.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Cargando...</div>
<div class="SRStatus" id="Searching">Buscando...</div>
<div class="SRStatus" id="NoMatches">Nada coincide</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Nubes de puntos</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Este documento explica algunos aspectos de la clase <a class="el" href="../../d4/d07/class_g_e_u_1_1_point_cloud.html">GEU::PointCloud</a>. Esta clase encapsula las utilidades asociadas al manejo de una nube de puntos.</p>
<h2><a class="anchor" id="autotoc_md-instrucciones-2"></a>
📘 Instrucciones</h2>
<h3><a class="anchor" id="como-cargar-la-nube"></a>
Como cargar la nube</h3>
<p>Para cargar la nube utilizaremos el FileManager. Mas concretamente, la función <em>loadPointCloud</em>. Dado que FileManager es una clase estática, la llamada a esta función se realizara de la siguiente manera: <code>FileManager::loadPointCloud(...)</code>. Cabe destacar que actualmente esta función soporta la carga de ficheros PLY, LAS y LAZ.</p>
<p>En el caso de que queramos cargar todas las nubes que hay en un directorio, podemos usar la función <em>loadAllCloudsUnderFolder(folder)</em>. Ambas funciones están especificadas con Doxygen, por lo que el IDE te puede dar mas información sobre como funcionan exactamente estas funciones.</p>
<h3><a class="anchor" id="como-obtener-la-nube"></a>
Como obtener la nube</h3>
<p>Para obtener la nube se debe utilizar la función <em>getPointCloud</em> de la clase <em>Renderer</em>. Esta pedirá como único parámetro el nombre de la nube. Nos devolverá un puntero a la misma en el caso de que esta exista en la escena activa o <em>nullptr</em> en caso contrario.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">auto</span> cloud = <a class="code hl_function" href="../../d1/d01/class_g_e_u_1_1_singleton.html#a47c7e7c2110f4cc59c9ff1f5594c366e">GEU::Renderer::getInstance</a>()-&gt;<a class="code hl_function" href="../../de/d04/class_g_e_u_1_1_renderer.html#ae941cdb83d15bb05ac73cf19173a1f84">getPointCloud</a>(<span class="stringliteral">&quot;ExamplePointCloud&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span>(cloud){</div>
<div class="line">  <span class="comment">//Do things</span></div>
<div class="line">}</div>
<div class="ttc" id="aclass_g_e_u_1_1_renderer_html_ae941cdb83d15bb05ac73cf19173a1f84"><div class="ttname"><a href="../../de/d04/class_g_e_u_1_1_renderer.html#ae941cdb83d15bb05ac73cf19173a1f84">GEU::Renderer::getPointCloud</a></div><div class="ttdeci">PointCloud * getPointCloud(const std::string &amp;cloudName) const</div><div class="ttdoc">get the cloud with the cloud name specified if it exists in the current active scene.</div><div class="ttdef"><b>Definition</b> Renderer.cpp:759</div></div>
<div class="ttc" id="aclass_g_e_u_1_1_singleton_html_a47c7e7c2110f4cc59c9ff1f5594c366e"><div class="ttname"><a href="../../d1/d01/class_g_e_u_1_1_singleton.html#a47c7e7c2110f4cc59c9ff1f5594c366e">GEU::Singleton&lt; Renderer &gt;::getInstance</a></div><div class="ttdeci">static Renderer * getInstance()</div><div class="ttdef"><b>Definition</b> Singleton.h:27</div></div>
</div><!-- fragment --><h3><a class="anchor" id="como-acceder-a-la-información-de-la-nube"></a>
Como acceder a la información de la nube</h3>
<p>Antes de nada es importante entender que información caracteriza un punto. En primer lugar tenemos su posición, el único dato que resulta esencial. Por otro lado tenemos lo que denominamos atributo, que no es más que información adicional de cada punto como, por ejemplo, el color RGB, temperatura, reflectancia espectral...</p>
<p>Actualmente, en el renderizado, solo se puede visualizar un atributo al mismo tiempo, siendo posible cambiar entre los atributos disponibles. En caso de atributos con múltiples bandas, como el caso de la multiespectral, solo se podrá visualizar una banda al mismo tiempo.</p>
<p>Otro aspecto a tener en cuenta es que <a class="el" href="../../d0/d01/namespace_g_e_u.html">GEU</a> utiliza un sistema de geometría virtualizada. Esto quiere decir que la nube puede visualizarse sin necesidad de que la misma esté completamente cargada en memoria. Por tanto, es posible que los datos que se requieran no esten cargados y se carguen en el momento de la solicitud.</p>
<p>Existen 3 maneras distintas de interactuar con la información de la nube:</p>
<ul>
<li><p class="startli">Los métodos <em>Have</em>: devuelven si la nube tiene información de determinado atributo y/o banda.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">auto</span> cloud = <a class="code hl_function" href="../../d1/d01/class_g_e_u_1_1_singleton.html#a47c7e7c2110f4cc59c9ff1f5594c366e">GEU::Renderer::getInstance</a>()-&gt;<a class="code hl_function" href="../../de/d04/class_g_e_u_1_1_renderer.html#ae941cdb83d15bb05ac73cf19173a1f84">getPointCloud</a>(<span class="stringliteral">&quot;ExamplePointCloud&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span>(cloud.have&lt;Attribute::Multispectral&gt;()){</div>
<div class="line">    <span class="comment">//Do things</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li><p class="startli">Los métodos <em>get</em>: devuelven una copia de los datos recien cargados de disco. Se debe de tener en cuenta que el método no comprueba si hay suficiente memoria para cargar todos los datos, dejando la responsabilidad de esto en quien use la función.</p>
<div class="fragment"></div><!-- fragment --><p> cpp const auto cloud = <a class="el" href="../../d1/d01/class_g_e_u_1_1_singleton.html#a47c7e7c2110f4cc59c9ff1f5594c366e">GEU::Renderer::getInstance()</a>-&gt;getPointCloud("ExamplePointCloud"); std::vector&lt;vec3&gt; positions = cloud.getPointsPosition() if(cloud.have&lt;Attribute::RGB&gt;()){ //Obtenemos el color de cada uno de los puntos std::vector&lt;u32Bits&gt; color = cloud.getAttribute&lt;Attribute::RGB&gt;(0, cloud.getNumberOfPoints(), 0 } </p><div class="fragment"></div><!-- fragment --></li>
<li><p class="startli">Los métodos <em>request</em>: permiten interactuar con el sistema de memoria virtual utilizado para el rendering. Se recomienda su uso en el caso de querer hacer los métodos compatibles con nubes de gran tamaño. Estos métodos no devuelven los datos en sí, siendo necesario acceder a los meshlets (<em>getMeshlets</em>) para obtenerlos. Cabe destacar que, una vez terminemos de utilizar estos métodos, debemos llamar a <em>returnControlToRenderer</em> para permitir que el sistema de renderizado pueda volver a utilizar el sistema de memoria virtual.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">auto</span> cloud = <a class="code hl_function" href="../../d1/d01/class_g_e_u_1_1_singleton.html#a47c7e7c2110f4cc59c9ff1f5594c366e">GEU::Renderer::getInstance</a>()-&gt;<a class="code hl_function" href="../../de/d04/class_g_e_u_1_1_renderer.html#ae941cdb83d15bb05ac73cf19173a1f84">getPointCloud</a>(<span class="stringliteral">&quot;ExamplePointCloud&quot;</span>);</div>
<div class="line"><span class="keyword">const</span> <span class="keyword">auto</span>&amp; meshlets = cloud.<a class="code hl_function" href="../../d4/d07/class_g_e_u_1_1_point_cloud.html#a00a0faeacb66351453a63b2577a9cbc0">getMeshlets</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;meshlets.size(); ++i){</div>
<div class="line">    <span class="keywordflow">if</span>(isVisible(meshlets[i])){</div>
<div class="line">        <span class="comment">//Si el meshlet está visible, solicitamos sus datos</span></div>
<div class="line">        cloud.requestMeshletData(i, cloud.getMeshletSize());</div>
<div class="line"> </div>
<div class="line">        <span class="comment">//En este punto no es recomendable hacer nada con los datos, pues seguramente no estén cargados.</span></div>
<div class="line">        <span class="comment">//Resulta más eficiente determinar que datos se van a necesitar, cargarlos y más tarde utilizarlos</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;meshlets.size(); ++i){</div>
<div class="line">    <span class="comment">//De igual manera, podemos descargar datos, liberando memoria.</span></div>
<div class="line">    cloud.unloadMeshletData(i);</div>
<div class="line">}</div>
<div class="line"><span class="comment">//Devolvemos el control al renderer</span></div>
<div class="line">cloud.returnControlToRenderer();</div>
<div class="ttc" id="aclass_g_e_u_1_1_point_cloud_html_a00a0faeacb66351453a63b2577a9cbc0"><div class="ttname"><a href="../../d4/d07/class_g_e_u_1_1_point_cloud.html#a00a0faeacb66351453a63b2577a9cbc0">GEU::PointCloud::getMeshlets</a></div><div class="ttdeci">const std::vector&lt; Meshlet &gt; &amp; getMeshlets()</div><div class="ttdef"><b>Definition</b> PointCloud.cpp:705</div></div>
</div><!-- fragment --></li>
</ul>
<h3><a class="anchor" id="como-modificar-la-nube"></a>
Como modificar la nube</h3>
<p><a class="el" href="../../d0/d01/namespace_g_e_u.html">GEU</a> está pensado para trabajar con nubes estáticas, por lo que no es recomendable modificar continuamente la nube, pues requiere de un precomputo para hacer funcionar el sistema de virtualización.</p>
<p>No obstante, para modificar la nube se pone a disposición funciones como <em>addPoints</em> o <em>setPoints</em>. Cabe destacar que tras añadir los datos que sean necesarios, se debe llamar a la función <em>SpatialOrdering</em> con sus parámetros por defecto para regenerar los <em>meshlets</em> y permitir que se renderice la nube. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->

